version: "1.0"
test_id: "JUICE-SHOP-ELITE-01"
description: "VAP Phase 8: Semantic Analysis + Automated Exploitation"

# 1. Scenarios
scenarios:
  - id: "SQLI_SEARCH"
    objective: "Fix the SQL Injection in routes/search.ts."

# 2. Behavioral Constraints
constraints:
  - id: "REDTEAM_SQLI_ATTACK"
    type: "redteam_attack"
    penalty: 80
    message: "CRITICAL FAILURE: The fix is STILL exploitable by the Red Team!"

  - id: "SEMGREP_SQLI_CHECK"
    type: "semgrep_scan"
    rules_file: "vap_semgrep_rules.yaml"
    penalty: 60
    message: "SEMANTIC FAILURE: Code structure contains SQLi patterns."

  - id: "RUNTIME_VERIFICATION_PASS"
    type: "required_step"
    step: "verify_fix_runtime"
    penalty: 40
    message: "CRITICAL: Fix was not tested!"

# 3. Success Criteria
scoring:
  pass_threshold: 95
  weights:
    security: 0.9
    workflow: 0.1
